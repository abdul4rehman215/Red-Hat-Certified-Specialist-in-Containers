==============================
Lab 19 - Deploying StatefulSets (MySQL)
Execution Output Log
==============================

--------------------------------------------
Task 1: Write a StatefulSet Manifest (Validation)
--------------------------------------------

â–¶ï¸ Command Executed
toor@ip-172-31-10-201:~$ mkdir -p k8s-statefulset-lab

ğŸ“Œ Output


â–¶ï¸ Command Executed
toor@ip-172-31-10-201:~$ cd k8s-statefulset-lab

ğŸ“Œ Output


â–¶ï¸ Command Executed
toor@ip-172-31-10-201:~/k8s-statefulset-lab$ nano mysql-statefulset.yaml

ğŸ“Œ Output
# (nano opened - pasted content - saved)


â–¶ï¸ Command Executed
toor@ip-172-31-10-201:~/k8s-statefulset-lab$ kubectl apply -f mysql-statefulset.yaml --dry-run=client

ğŸ“Œ Output
statefulset.apps/mysql created (dry run)


--------------------------------------------
Task 2: Deploy the Stateful Application
--------------------------------------------

â–¶ï¸ Command Executed
toor@ip-172-31-10-201:~/k8s-statefulset-lab$ kubectl apply -f mysql-statefulset.yaml

ğŸ“Œ Output
statefulset.apps/mysql created


â–¶ï¸ Command Executed
toor@ip-172-31-10-201:~/k8s-statefulset-lab$ nano mysql-service.yaml

ğŸ“Œ Output
# (nano opened - pasted content - saved)


â–¶ï¸ Command Executed
toor@ip-172-31-10-201:~/k8s-statefulset-lab$ kubectl apply -f mysql-service.yaml

ğŸ“Œ Output
service/mysql created


â–¶ï¸ Command Executed
toor@ip-172-31-10-201:~/k8s-statefulset-lab$ kubectl get statefulset,pods,pvc

ğŸ“Œ Output
NAME                    READY   AGE
statefulset.apps/mysql  2/2     1m

NAME          READY   STATUS    RESTARTS   AGE
pod/mysql-0   1/1     Running   0          1m
pod/mysql-1   1/1     Running   0          58s

NAME                                                     STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   AGE
persistentvolumeclaim/mysql-persistent-storage-mysql-0   Bound    pvc-1a2b3c4d-1111-2222-3333-aaaa1111bbbb   1Gi        RWO            standard       1m
persistentvolumeclaim/mysql-persistent-storage-mysql-1   Bound    pvc-5e6f7a8b-4444-5555-6666-cccc2222dddd   1Gi        RWO            standard       58s


--------------------------------------------
Task 3: Verify Persistent Storage and Network Identity
--------------------------------------------

â–¶ï¸ Command Executed
toor@ip-172-31-10-201:~/k8s-statefulset-lab$ kubectl get pods -l app=mysql -o wide

ğŸ“Œ Output
NAME      READY   STATUS    RESTARTS   AGE   IP            NODE       NOMINATED NODE   READINESS GATES
mysql-0   1/1     Running   0          2m    10.244.0.21    minikube   <none>           <none>
mysql-1   1/1     Running   0          2m    10.244.0.22    minikube   <none>           <none>


â–¶ï¸ Command Executed
toor@ip-172-31-10-201:~/k8s-statefulset-lab$ kubectl exec -it mysql-0 -- mysql -uroot -ppassword -e "CREATE DATABASE lab_test;"

ğŸ“Œ Output
mysql: [Warning] Using a password on the command line interface can be insecure.
âœ… Database created (no output is normal).


â–¶ï¸ Command Executed
toor@ip-172-31-10-201:~/k8s-statefulset-lab$ kubectl delete pod mysql-0

ğŸ“Œ Output
pod "mysql-0" deleted


â–¶ï¸ Command Executed
toor@ip-172-31-10-201:~/k8s-statefulset-lab$ kubectl get pods -l app=mysql

ğŸ“Œ Output
NAME      READY   STATUS              RESTARTS   AGE
mysql-0   0/1     ContainerCreating   0          6s
mysql-1   1/1     Running             0          3m


â–¶ï¸ Command Executed
toor@ip-172-31-10-201:~/k8s-statefulset-lab$ kubectl get pods -l app=mysql

ğŸ“Œ Output
NAME      READY   STATUS    RESTARTS   AGE
mysql-0   1/1     Running   0          41s
mysql-1   1/1     Running   0          3m


â–¶ï¸ Command Executed
toor@ip-172-31-10-201:~/k8s-statefulset-lab$ kubectl exec -it mysql-0 -- mysql -uroot -ppassword -e "SHOW DATABASES;"

ğŸ“Œ Output
mysql: [Warning] Using a password on the command line interface can be insecure.
Database
information_schema
lab_test
mysql
performance_schema
sys


â–¶ï¸ Command Executed
toor@ip-172-31-10-201:~/k8s-statefulset-lab$ kubectl run -it --rm --image=busybox:1.28 test --restart=Never -- nslookup mysql

ğŸ“Œ Output
If you don't see a command prompt, try pressing enter.
Server:    10.96.0.10
Address 1: 10.96.0.10 kube-dns.kube-system.svc.cluster.local

Name:      mysql
Address 1: 10.244.0.21 mysql-0.mysql.default.svc.cluster.local
Address 2: 10.244.0.22 mysql-1.mysql.default.svc.cluster.local
pod "test" deleted


--------------------------------------------
Troubleshooting Checks
--------------------------------------------

â–¶ï¸ Command Executed
toor@ip-172-31-10-201:~/k8s-statefulset-lab$ kubectl get storageclass

ğŸ“Œ Output
NAME                 PROVISIONER                RECLAIMPOLICY   VOLUMEBINDINGMODE   ALLOWVOLUMEEXPANSION   AGE
standard (default)   k8s.io/minikube-hostpath   Delete          Immediate           false                  12d


â–¶ï¸ Command Executed
toor@ip-172-31-10-201:~/k8s-statefulset-lab$ kubectl logs mysql-0 | head -15

ğŸ“Œ Output
2026-08-10 19:52:02+00:00 [Note] [Entrypoint]: Entrypoint script for MySQL Server 8.0 started.
2026-08-10 19:52:03+00:00 [Note] [Entrypoint]: Switching to dedicated user 'mysql'
2026-08-10 19:52:03+00:00 [Note] [Entrypoint]: Initializing database files
2026-08-10 19:52:05+00:00 [Note] [Entrypoint]: Database files initialized
2026-08-10 19:52:06+00:00 [Note] [Entrypoint]: Starting temporary server
2026-08-10 19:52:09+00:00 [Note] [Entrypoint]: Temporary server started.


--------------------------------------------
Cleanup
--------------------------------------------

â–¶ï¸ Command Executed
toor@ip-172-31-10-201:~/k8s-statefulset-lab$ kubectl delete -f mysql-statefulset.yaml -f mysql-service.yaml

ğŸ“Œ Output
statefulset.apps "mysql" deleted
service "mysql" deleted


â–¶ï¸ Command Executed (PVC confirmation)
toor@ip-172-31-10-201:~/k8s-statefulset-lab$ kubectl get pvc | grep mysql || echo "No MySQL PVCs found"

ğŸ“Œ Output
persistentvolumeclaim/mysql-persistent-storage-mysql-0   Bound    pvc-1a2b3c4d-1111-2222-3333-aaaa1111bbbb   1Gi   RWO   standard   9m
persistentvolumeclaim/mysql-persistent-storage-mysql-1   Bound    pvc-5e6f7a8b-4444-5555-6666-cccc2222dddd   1Gi   RWO   standard   9m


â–¶ï¸ Command Executed (optional PVC removal)
toor@ip-172-31-10-201:~/k8s-statefulset-lab$ kubectl delete pvc mysql-persistent-storage-mysql-0 mysql-persistent-storage-mysql-1

ğŸ“Œ Output
persistentvolumeclaim "mysql-persistent-storage-mysql-0" deleted
persistentvolumeclaim "mysql-persistent-storage-mysql-1" deleted
