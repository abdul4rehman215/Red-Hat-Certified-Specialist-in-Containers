==============================
Lab 17 - Compose with Dependencies (docker-compose)
Execution Output Log
==============================

--------------------------------------------
Lab Setup
--------------------------------------------

â–¶ï¸ Command Executed
toor@ip-172-31-10-182:~$ mkdir compose-dependencies-lab

ğŸ“Œ Output


â–¶ï¸ Command Executed
toor@ip-172-31-10-182:~$ cd compose-dependencies-lab

ğŸ“Œ Output


â–¶ï¸ Command Executed
toor@ip-172-31-10-182:~/compose-dependencies-lab$ pwd

ğŸ“Œ Output
/home/toor/compose-dependencies-lab


--------------------------------------------
Task 1: Using depends_on Directive
--------------------------------------------

â–¶ï¸ Command Executed
toor@ip-172-31-10-182:~/compose-dependencies-lab$ nano docker-compose.yml

ğŸ“Œ Output
# (nano opened - pasted YAML content - saved)


ğŸ“„ docker-compose.yml (depends_on version)
version: '3.8'
services:
  redis:
    image: redis:alpine
    ports:
      - "6379:6379"

  webapp:
    image: nginx:alpine
    ports:
      - "8080:80"
    depends_on:
      - redis


â–¶ï¸ Command Executed
toor@ip-172-31-10-182:~/compose-dependencies-lab$ docker-compose up -d

ğŸ“Œ Output
[+] Running 15/15
 âœ” Network compose-dependencies-lab_default      Created                          0.2s
 âœ” Container compose-dependencies-lab-redis-1    Pulling                          1.8s
 âœ” Container compose-dependencies-lab-webapp-1   Pulling                          1.7s
 âœ” Container compose-dependencies-lab-redis-1    Pulled                           2.1s
 âœ” Container compose-dependencies-lab-webapp-1   Pulled                           2.0s
 âœ” Container compose-dependencies-lab-redis-1    Created                          0.3s
 âœ” Container compose-dependencies-lab-webapp-1   Created                          0.3s
 âœ” Container compose-dependencies-lab-redis-1    Started                          0.4s
 âœ” Container compose-dependencies-lab-webapp-1   Started                          0.5s


â–¶ï¸ Command Executed
toor@ip-172-31-10-182:~/compose-dependencies-lab$ docker-compose ps

ğŸ“Œ Output
NAME                              IMAGE         COMMAND                  SERVICE   CREATED          STATUS          PORTS
compose-dependencies-lab-redis-1   redis:alpine  "docker-entrypoint.sâ€¦"   redis     29 seconds ago   Up 27 seconds   0.0.0.0:6379->6379/tcp
compose-dependencies-lab-webapp-1  nginx:alpine  "/docker-entrypoint.â€¦"   webapp    29 seconds ago   Up 26 seconds   0.0.0.0:8080->80/tcp


â–¶ï¸ Command Executed
toor@ip-172-31-10-182:~/compose-dependencies-lab$ curl -I http://localhost:8080 | head -10

ğŸ“Œ Output
HTTP/1.1 200 OK
Server: nginx/1.26.2
Date: Sat, 10 Aug 2026 19:10:58 GMT
Content-Type: text/html
Content-Length: 615
Last-Modified: Tue, 16 Jul 2024 15:01:00 GMT
Connection: keep-alive
ETag: "6696a5dc-267"
Accept-Ranges: bytes


--------------------------------------------
Task 2: Scale Service Replicas
--------------------------------------------

â–¶ï¸ Command Executed
toor@ip-172-31-10-182:~/compose-dependencies-lab$ nano docker-compose.yml

ğŸ“Œ Output
# (nano opened - updated YAML for scaling variant)


ğŸ“„ docker-compose.yml (scaling version)
version: '3.8'
services:
  redis:
    image: redis:alpine
    ports:
      - "6379:6379"

  webapp:
    image: nginx:alpine
    depends_on:
      - redis
    deploy:
      replicas: 3


â–¶ï¸ Command Executed
toor@ip-172-31-10-182:~/compose-dependencies-lab$ docker-compose up -d --scale webapp=3

ğŸ“Œ Output
[+] Running 5/5
 âœ” Container compose-dependencies-lab-webapp-1   Running                          0.0s
 âœ” Container compose-dependencies-lab-webapp-2   Started                          0.6s
 âœ” Container compose-dependencies-lab-webapp-3   Started                          0.6s
 âœ” Container compose-dependencies-lab-redis-1    Running                          0.0s
 âœ” Network compose-dependencies-lab_default      Created                          0.0s


â–¶ï¸ Command Executed
toor@ip-172-31-10-182:~/compose-dependencies-lab$ docker-compose ps

ğŸ“Œ Output
NAME                               IMAGE         COMMAND                  SERVICE   CREATED          STATUS          PORTS
compose-dependencies-lab-redis-1    redis:alpine  "docker-entrypoint.sâ€¦"   redis     3 minutes ago    Up 3 minutes    0.0.0.0:6379->6379/tcp
compose-dependencies-lab-webapp-1   nginx:alpine  "/docker-entrypoint.â€¦"   webapp    3 minutes ago    Up 3 minutes
compose-dependencies-lab-webapp-2   nginx:alpine  "/docker-entrypoint.â€¦"   webapp    12 seconds ago   Up 10 seconds
compose-dependencies-lab-webapp-3   nginx:alpine  "/docker-entrypoint.â€¦"   webapp    12 seconds ago   Up 10 seconds


â–¶ï¸ Command Executed
toor@ip-172-31-10-182:~/compose-dependencies-lab$ docker-compose exec webapp hostname

ğŸ“Œ Output
7c3a1b2d91f4


â–¶ï¸ Command Executed
toor@ip-172-31-10-182:~/compose-dependencies-lab$ docker-compose exec webapp-1 hostname

ğŸ“Œ Output
7c3a1b2d91f4


â–¶ï¸ Command Executed
toor@ip-172-31-10-182:~/compose-dependencies-lab$ docker-compose exec webapp-2 hostname

ğŸ“Œ Output
9a8f0c4e1d3a


â–¶ï¸ Command Executed
toor@ip-172-31-10-182:~/compose-dependencies-lab$ docker-compose exec webapp-3 hostname

ğŸ“Œ Output
1f2e3d4c5b6a


--------------------------------------------
Task 3: Test Inter-Service Connectivity (Flask + Redis)
--------------------------------------------

â–¶ï¸ Command Executed
toor@ip-172-31-10-182:~/compose-dependencies-lab$ nano app.py

ğŸ“Œ Output
# (nano opened - pasted Flask app - saved)


â–¶ï¸ Command Executed
toor@ip-172-31-10-182:~/compose-dependencies-lab$ nano Dockerfile

ğŸ“Œ Output
# (nano opened - pasted Dockerfile - saved)


â–¶ï¸ Command Executed
toor@ip-172-31-10-182:~/compose-dependencies-lab$ nano docker-compose.yml

ğŸ“Œ Output
# (nano opened - updated YAML for Flask + Redis build - saved)


ğŸ“„ docker-compose.yml (Flask + Redis)
version: '3.8'
services:
  redis:
    image: redis:alpine

  webapp:
    build: .
    ports:
      - "5000:5000"
    environment:
      - REDIS_HOST=redis
    depends_on:
      - redis


â–¶ï¸ Command Executed
toor@ip-172-31-10-182:~/compose-dependencies-lab$ docker-compose up -d

ğŸ“Œ Output
[+] Running 10/10
 âœ” Network compose-dependencies-lab_default      Created                          0.2s
 âœ” Container compose-dependencies-lab-redis-1    Created                          0.3s
 âœ” Container compose-dependencies-lab-redis-1    Started                          0.5s
 âœ” Container compose-dependencies-lab-webapp-1   Building                         6.8s
 âœ” Container compose-dependencies-lab-webapp-1   Created                          0.3s
 âœ” Container compose-dependencies-lab-webapp-1   Started                          0.5s


â–¶ï¸ Command Executed
toor@ip-172-31-10-182:~/compose-dependencies-lab$ docker-compose ps

ğŸ“Œ Output
NAME                              IMAGE                           COMMAND           SERVICE   CREATED         STATUS         PORTS
compose-dependencies-lab-redis-1   redis:alpine                    "docker-entryâ€¦"  redis     8 seconds ago   Up 6 seconds   6379/tcp
compose-dependencies-lab-webapp-1  compose-dependencies-lab-webapp  "python app.py"  webapp    7 seconds ago   Up 5 seconds   0.0.0.0:5000->5000/tcp


â–¶ï¸ Command Executed
toor@ip-172-31-10-182:~/compose-dependencies-lab$ curl http://localhost:5000

ğŸ“Œ Output
Hello World! This page has been viewed 1 times.


â–¶ï¸ Command Executed
toor@ip-172-31-10-182:~/compose-dependencies-lab$ curl http://localhost:5000

ğŸ“Œ Output
Hello World! This page has been viewed 2 times.


â–¶ï¸ Command Executed
toor@ip-172-31-10-182:~/compose-dependencies-lab$ curl http://localhost:5000

ğŸ“Œ Output
Hello World! This page has been viewed 3 times.


â–¶ï¸ Command Executed (optional logs check)
toor@ip-172-31-10-182:~/compose-dependencies-lab$ docker-compose logs --tail=15 webapp

ğŸ“Œ Output
webapp-1  * Serving Flask app 'app'
webapp-1  * Debug mode: off
webapp-1  WARNING: This is a development server. Do not use it in a production deployment.
webapp-1  * Running on all addresses (0.0.0.0)
webapp-1  * Running on http://127.0.0.1:5000
webapp-1  * Running on http://172.20.0.3:5000
webapp-1  172.20.0.1 - - [10/Aug/2026 19:18:05] "GET / HTTP/1.1" 200 -
webapp-1  172.20.0.1 - - [10/Aug/2026 19:18:10] "GET / HTTP/1.1" 200 -


â–¶ï¸ Command Executed (connectivity troubleshooting commands)
toor@ip-172-31-10-182:~/compose-dependencies-lab$ docker-compose exec redis redis-cli ping

ğŸ“Œ Output
PONG


â–¶ï¸ Command Executed
toor@ip-172-31-10-182:~/compose-dependencies-lab$ docker-compose exec webapp python -c "import redis; r=redis.Redis(host='redis', port=6379); print(r.ping())"

ğŸ“Œ Output
True


--------------------------------------------
Cleanup
--------------------------------------------

â–¶ï¸ Command Executed
toor@ip-172-31-10-182:~/compose-dependencies-lab$ docker-compose down

ğŸ“Œ Output
[+] Running 3/3
 âœ” Container compose-dependencies-lab-webapp-1   Removed                          0.6s
 âœ” Container compose-dependencies-lab-redis-1    Removed                          0.4s
 âœ” Network compose-dependencies-lab_default      Removed                          0.2s


â–¶ï¸ Command Executed (optional image check)
toor@ip-172-31-10-182:~/compose-dependencies-lab$ docker images | head -10

ğŸ“Œ Output
REPOSITORY                       TAG        IMAGE ID       CREATED          SIZE
compose-dependencies-lab-webapp   latest     8c1f2a3b4c5d   2 minutes ago    62.3MB
redis                            alpine     9c8b7a6d5e4f   3 weeks ago      7.1MB
nginx                            alpine     2d3c4b5a6f7e   2 weeks ago      47.8MB


â–¶ï¸ Command Executed
toor@ip-172-31-10-182:~/compose-dependencies-lab$ docker rmi compose-dependencies-lab-webapp:latest

ğŸ“Œ Output
Untagged: compose-dependencies-lab-webapp:latest
Deleted: sha256:8c1f2a3b4c5d9e8f7a6b5c4d3e2f1a0b...
